function play(){playing||(playing=!0,speaking?(console.log("resume",speech),window.speechSynthesis.resume()):(speaking=!0,console.log("play",speech),window.speechSynthesis.speak(speech)),setTimeout(toggleButtons,500))}function pause(){pausing||(pausing=!0,window.speechSynthesis.pause(),console.log("pause",speech),setTimeout(toggleButtons,500))}function adjustSpeed(){console.log("cancelling the original utterance"),window.speechSynthesis.cancel(),console.log("progress char",progress_index);var e=speech.text.lastIndexOf(" ",progress_index);console.log("found a space at char",e),speech.text=speech.text.slice(e),console.log("new text",speech.text),speed=Math.round(10*$speed_value.value)/10,speed>10?(speed=10,$faster.disabled=!0):speed<.1&&(speed=.1,$slower.disabled=!0),speech.rate=speed,console.log("starting a new one",speech),window.speechSynthesis.speak(speech)}function toggleButtons(){playing=!1,pausing=!1,$play.disabled===!1}if(function(e,t){"use strict";if("querySelectorAll"in t){var n=t.createElement("script"),o=t.querySelector(".entry__jump--webmentions a"),i=t.querySelectorAll(".webmentions__item").length;o.innerHTML=i+" "+o.innerHTML,"AG"in e&&"preconnect"in e.AG&&(e.AG.preconnect("//disqus.com/"),e.AG.preconnect("//aarongustafson.disqus.com"),e.AG.preconnect("//links.services.disqus.com/"),e.AG.preconnect("//a.disquscdn.com")),n.async=!0,n.type="text/javascript",n.src="//aarongustafson.disqus.com/count.js",(t.head||t.body).appendChild(n)}}(this,this.document),function(e,t){"use strict";var n=t.createElement("script");n.src="//"+e.AG.disqus.shortname+".disqus.com/"+e.AG.disqus.script,n.setAttribute("data-timestamp",""+new Date),(t.head||t.body).appendChild(n),n=null}(this,this.document),function(){"use strict";if("onLine"in window.navigator){var e,t,n=!window.navigator.onLine;n&&(e=document.createElement("p"),e.innerText="Your internet connection is currently offline, so I can’t load in the comment thread from Disqus.",t=document.getElementById("disqus"),t.appendChild(e),e=null,t=null)}}(),function(e){"use strict";if("querySelectorAll"in e){var t,n,o,i,a,l,s,r,c=e.querySelectorAll("[data-quotable]"),d=c.length,u=/^(blockquote|[uod]l|p|h[1-6])$/,p=/^(body|main|section|article|aside)$/,h=/^h[1-6]$/;if(d)for(a=e.createElement("blockquote"),a.setAttribute("class","quotable"),a.setAttribute("aria-hidden","true"),a.appendChild(e.createElement("p"));d--;){for(t=c[d],n=a.cloneNode(!0),o=t.innerText.split(" "),i=o.pop(),n.querySelector("p").innerText=o.join(" ")+" "+i;!t.nodeName.toLowerCase().match(u)&&!t.nodeName.toLowerCase().match(p);)t=t.parentNode;for(l=t.parentNode,s=t.previousElementSibling;s;){if(s.nodeName.toLowerCase().match(h)){r=s;break}s=s.previousElementSibling}if(r)for(s=r.nextElementSibling.nextElementSibling;"blockquote"==s.nodeName.toLowerCase();)s=s.nextElementSibling.nextElementSibling;s?l.insertBefore(n,s):l.insertBefore(n,t)}}}(document),function(e,t){"use strict";function n(t){var n=t.target;return"a"==t.target.nodeName.toLowerCase()&&e.innerWidth>=i?(t.preventDefault(),e.open(n.href,"share-this","height=300,width=500,status=no,toolbar=no"),!1):void 0}if("querySelectorAll"in t){var o=t.querySelectorAll(".entry__sharing"),i=640;o.length>0&&o[0].addEventListener("click",n,!1)}}(this,this.document),function(e){"use strict";function t(){for(var e=document.getElementById("webmentions").getElementsByTagName("img"),t=e.length;t--;)e[t].naturalWidth||(e[t].style.visibility="hidden");e=null}"addEventListener"in e&&e.addEventListener("load",t,!1)}(this),"speechSynthesis"in window){window.addEventListener("beforeunload",function(){window.speechSynthesis.cancel()});var speech=new SpeechSynthesisUtterance,speaking=!1,pausing=!1,playing=!1,text,progress_index=0,$content=document.querySelector("main").cloneNode(!0),$space=$content.querySelectorAll("pre"),$pause_before=$content.querySelectorAll("h2, h3, h4, h5, h6, p, li, dt, blockquote, pre, figure, footer"),$skip=$content.querySelectorAll(".anchorable__anchor, aside, .dont_read"),$intro=document.createElement("dt"),$controls=document.createElement("dd"),$button=document.createElement("button"),$buttons=document.createElement("p"),$play,$pause,default_speed=1.4,$speed=$buttons.cloneNode(!0),$speed_label=document.createElement("label"),$speed_value=document.createElement("input"),$caveat=$buttons.cloneNode(!0);$skip.forEach(function(e){e.innerHTML=""}),$space.forEach(function(e){e.innerHTML=" "+e.innerHTML.replace(/[\r\n\t]/g," ")+" "}),$pause_before.forEach(function(e){e.innerHTML=" , "+e.innerHTML}),speech.onboundary=function(e){"word"==e.name&&(progress_index=e.charIndex)},speech.onend=function(e){window.speechSynthesis.cancel()},text=$content.textContent,speech.text=text,$intro.innerHTML="Would you prefer to have this post read to you?",$controls.classList.add("media-controls"),$buttons.classList.add("media-controls__buttons"),$button.classList.add("media-controls__button"),$play=$button.cloneNode("true"),$play.classList.add("media-controls__button--play"),$play.setAttribute("aria-label","Play"),$play.addEventListener("click",play,!1),$play.addEventListener("touchend",play,!1),$buttons.appendChild($play),$pause=$button.cloneNode("true"),$pause.classList.add("media-controls__button--pause"),$pause.setAttribute("aria-label","Pause"),$pause.addEventListener("click",pause,!1),$pause.addEventListener("touchend",pause,!1),$buttons.appendChild($pause),$controls.appendChild($buttons),speech.rate=default_speed,$caveat.innerHTML="<small>SpeechSynthesis is still experimental. This could be buggy</small>",$controls.appendChild($caveat),document.querySelector(".entry__meta").appendChild($intro),document.querySelector(".entry__meta").appendChild($controls)}!function(e,t){"use strict";function n(e){var n=!("data"in e),o=n?e:e.data,a=n?e.element_id:e.id,l=!1,s=!1;if(a=a.toString(),o.url&&o.url.indexOf("twitter.com/")>-1&&(l=!0,-1==o.url.indexOf("#favorited-by")&&(a=o.url.replace(/^.*?status\/(.*)$/,"$1"))),!(g.indexOf(a)>-1)){o.url.indexOf("/googleplus/")&&(s=!0);var p,m,b,f=c.li.cloneNode(!0),y=c.article.cloneNode(!0),w=c.author.cloneNode(!0),_=c.author_name.cloneNode(!0),N=c.author_link.cloneNode(!0),$=c.photo.cloneNode(!0),v=c.meta.cloneNode(!0),S=c.time.cloneNode(!0),x=o.name,E=!1,C=o.content,A=o.url||e.source,q=e.activity.type,k=o.author?o.author.name:!1,L=o.author?o.author.photo:!1,T="";f.id="webmention-"+a,f.appendChild(y),(x||C)&&(k?(L?($.src=L,N.appendChild($)):y.className+=" webmention--no-photo",_.appendChild(t.createTextNode(k)),o.author.url?(N.href=o.author.url,N.appendChild(_),w.appendChild(N)):w.appendChild(_),y.appendChild(w)):y.className+=" webmention--no-author",q||(q=s?A.indexOf("/like/")>-1?"like":A.indexOf("/repost/")>-1?"repost":A.indexOf("/comment/")>-1?"reply":"link":"post"),x&&x.length>200&&(x=!1),"post"==q||"link"==q&&!l&&!s?(E=x,!x&&A&&i(A,function(e){e&&linkTitle(f,A,e)})):"like"!=q&&"repost"!=q||(E="like"==q&&l?k+" favorited this.":"repost"==q&&l?k+" retweeted this.":x,y.className+=" webmention--author-starts"),o.published_ts?(b=new Date(0),b.setUTCSeconds(o.published_ts)):(o.published||e.verified_date)&&(b=new Date(o.published||e.verified_date)),b&&(S.setAttribute("datetime",b.toISOString()),T+=b.getUTCDate()+" ",T+=u[b.getUTCMonth()]+" ",T+=b.getUTCFullYear(),S.appendChild(t.createTextNode(T)),v.appendChild(S)),E||(b&&A&&v.appendChild(t.createTextNode(" | ")),A&&(m=c.permalink.cloneNode(!0),m.href=A,v.appendChild(m))),k&&-1==y.className.indexOf("webmention--author-starts")&&(x&&"0"==x.indexOf(k)||C&&"0"==C.indexOf(k))&&(y.className+=" webmention--author-starts"),E?(y.className+=" webmention--title-only",E=E.replace("reposts","reposted"),A?(m=c.a.cloneNode(!0),m.href=A,m.appendChild(t.createTextNode(E))):m=t.createTextNode(E),p=c.title.cloneNode(!0),p.appendChild(m),y.appendChild(d.cloneNode(!0)),y.appendChild(p)):(y.className+=" webmention--content-only",p=c.content.cloneNode(!0),p.innerHTML=C,y.appendChild(p)),v.children.length>0&&y.appendChild(v),h&&(h.parentNode.replaceChild(r,h),h=!1),r.appendChild(f),g.push(a),f=null,y=null,w=null,_=null,N=null,$=null,p=null,m=null,v=null,S=null)}}function o(){var e=t.querySelector(".entry__jump--webmentions a"),n=t.querySelectorAll(".webmentions__item").length;e.innerHTML=n+" webmentions"}function i(t,n){if("XMLHttpRequest"in e){var o=new XMLHttpRequest;i=function(e,t){var n=!1;e="//whateverorigin.org/get?url="+encodeURIComponent(e),o.onreadystatechange=function(){4!=this.readyState||n||(n=!0,t(o.responseText))},xhr.onabort=function(){n||(n=!0,t(!1))},o.onerror=o.onabort,o.open("GET",e),o.send(null)}}else i=function(e,t){t(!1)};return i(t,n)}if("querySelectorAll"in t){"AG"in e||(e.AG={}),e.location.origin||(e.location.origin=e.location.protocol+"//"+e.location.host);var a,l,s,r=t.querySelectorAll(".webmentions__list"),c={a:t.createElement("a"),author_name:t.createElement("b"),article:t.createElement("article"),div:t.createElement("div"),photo:t.createElement("img"),li:t.createElement("li"),time:t.createElement("time")},d=t.createTextNode(" "),u=["January","February","March","April","May","June","July","August","September","October","November","December"],p=[],h=!1,m=t.querySelector('meta[property="webmention:redirected_from"]'),b=[],f=e.location.origin,g=[],y=0;if(p.push("https://www.aaron-gustafson.com"+e.location.pathname),m&&(l=m.getAttribute("content").split(","),l.forEach(function(e){p.push(e.indexOf("//")<0?f+e:e)}),l=!1),"http:"!=e.location.protocol&&(p.forEach(function(e){b.push(e),-1!=e.indexOf("https://")&&b.push(e.replace("https://","http://"))}),p=b,b=!1),r.length<1){if(h=t.querySelectorAll(".webmentions__not-found"),!h.length)return;h=h[0],r=t.createElement("ol"),r.className="webmentions__list"}else{for(r=r[0],s=r.querySelectorAll("[id^=webmention-]"),y=s.length;y--;)g.push(s[y].getAttribute("id").replace("webmention-",""));s=null}if(e.AG.existing_webmentions=g,c.li.className="webmentions__item",c.article.className="h-cite webmention",c.time.className="webmention__pubdate dt-published",c.author=c.div.cloneNode(),c.author.className="webmention__author p-author h-card",c.author_name.className="p-name",c.author_link=c.a.cloneNode(),c.author_link.className="u-url",c.photo.className="webmention__author__photo u-photo",c.photo.alt="",c.title=c.div.cloneNode(),c.title.className="webmention__title p-name",c.permalink=c.a.cloneNode(),c.permalink.className="webmention__source u-url",c.permalink.appendChild(t.createTextNode("Permalink")),c.content=c.div.cloneNode(),c.content.className="webmention__content p-content",c.meta=c.div.cloneNode(),c.meta.className="webmention__meta",e.AG.processWebmentions=function(e){!e||"error"in e||(e.links.reverse(),e.links.forEach(n),o())},"preconnect"in e.AG&&(e.AG.preconnect("//webmention.io"),e.AG.preconnect("ws://webmention.io:8080")),a=t.createElement("script"),a.async=!0,a.src="//webmention.io/api/mentions?jsonp=window.AG.processWebmentions&target[]="+p.join("&target[]="),t.getElementsByTagName("head")[0].appendChild(a),r.length&&"WebSocket"in e){var w=new WebSocket("ws://webmention.io:8080");w.onopen=function(){w.send(e.location)},w.onmessage=function(e){n(JSON.parse(e.data)),o()}}}}(this,this.document);